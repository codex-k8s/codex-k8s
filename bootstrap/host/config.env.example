# Target host (Ubuntu 24.04)
TARGET_HOST=""
TARGET_PORT="22"
TARGET_ROOT_USER="root"
TARGET_ROOT_SSH_KEY="${HOME}/.ssh/id_rsa"

# New operator user created on target host
OPERATOR_USER="codex"
OPERATOR_SSH_PUBKEY_PATH="${HOME}/.ssh/id_rsa.pub"

# GitHub repository (owner/name)
CODEXK8S_GITHUB_REPO=""

# External credentials (optional in file; if empty script will ask interactively)
# Required: fine-grained GitHub token used by bootstrap/ARC/Kaniko.
# Minimum permissions: repository contents (read), actions (read/write), secrets (read/write), variables (read/write), administration (read/write as needed).
CODEXK8S_GITHUB_PAT=""
CODEXK8S_OPENAI_API_KEY=""
CODEXK8S_CONTEXT7_API_KEY=""

# Staging settings
CODEXK8S_STAGING_NAMESPACE="codex-k8s-ai-staging"
# Required: must resolve to TARGET_HOST before bootstrap starts.
CODEXK8S_STAGING_DOMAIN="staging.example.com"
# Required for Let's Encrypt account registration.
CODEXK8S_LETSENCRYPT_EMAIL="ops@example.com"
CODEXK8S_LETSENCRYPT_SERVER="https://acme-v02.api.letsencrypt.org/directory"

# Internal registry (no auth by design for MVP).
# Security model for staging: registry listens on node loopback (127.0.0.1) only.
# This profile is intended for single-node staging.
CODEXK8S_INTERNAL_REGISTRY_SERVICE="codex-k8s-registry"
CODEXK8S_INTERNAL_REGISTRY_PORT="5000"
CODEXK8S_INTERNAL_REGISTRY_STORAGE_SIZE="20Gi"
CODEXK8S_INTERNAL_REGISTRY_HOST="127.0.0.1:5000"
CODEXK8S_INTERNAL_IMAGE_REPOSITORY="codex-k8s/codex-k8s"
# Keep empty to let bootstrap autogenerate from CODEXK8S_INTERNAL_REGISTRY_HOST.
CODEXK8S_IMAGE=""
CODEXK8S_KANIKO_TIMEOUT="1800s"
# Learning mode default for newly created projects.
# Keep "true" to enable educational explanations by default.
# Set empty value to disable by default.
CODEXK8S_LEARNING_MODE_DEFAULT="true"

# Runner/ARC
CODEXK8S_ENABLE_GITHUB_RUNNER="true"
CODEXK8S_RUNNER_MIN="1"
CODEXK8S_RUNNER_MAX="2"
CODEXK8S_RUNNER_NAMESPACE="actions-runner-staging"
CODEXK8S_RUNNER_SCALE_SET_NAME="codex-k8s-ai-staging"
CODEXK8S_RUNNER_IMAGE="ghcr.io/actions/actions-runner:latest"
CODEXK8S_WAIT_ROLLOUT="true"

# Timeouts and retries for slower servers/networks.
CODEXK8S_DNS_WAIT_TIMEOUT="900"
CODEXK8S_DNS_WAIT_INTERVAL="10"
CODEXK8S_NODE_DISCOVERY_TIMEOUT="300"
CODEXK8S_NODE_READY_TIMEOUT="1200s"
CODEXK8S_INGRESS_READY_TIMEOUT="1200s"
CODEXK8S_CERT_MANAGER_READY_TIMEOUT="1200s"
CODEXK8S_HELM_TIMEOUT="20m"
CODEXK8S_ROLLOUT_TIMEOUT="1800s"

# Optional storage profile for bootstrap.
# For staging/single-node k3s, PVC works without Longhorn via the default local-path provisioner.
CODEXK8S_INSTALL_LONGHORN="false"
# For bare-metal/staging without cloud LoadBalancer expose ingress directly on host :80/:443.
CODEXK8S_INGRESS_HOST_NETWORK="true"

# Host firewall hardening (recommended).
# When enabled, external inbound access is limited to CODEXK8S_SSH_PORT, 80 and 443.
CODEXK8S_FIREWALL_ENABLED="true"
# Keep equal to TARGET_PORT unless you intentionally expose SSH on another port.
CODEXK8S_SSH_PORT="22"

# NetworkPolicy baseline in Kubernetes (recommended).
# Labels platform/system namespaces and applies baseline restrictions for platform traffic.
CODEXK8S_NETWORK_POLICY_BASELINE="true"
# codex-k8s MCP HTTP port in platform namespace (used by project/agent policy template).
CODEXK8S_PLATFORM_MCP_PORT="80"
